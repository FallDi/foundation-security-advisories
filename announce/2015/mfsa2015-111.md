---
announced: September 22, 2015
fixed_in:
- Firefox 41
- Firefox ESR 38.3
- SeaMonkey 2.38
impact: High
reporter: Ehsan Akhgari
title: Errors in the handling of CORS preflight request headers
---

<h3>Description</h3>

<p>Mozilla developer <strong>Ehsan Akhgari</strong> reported two issues with Cross-origin
resource sharing (CORS) "preflight" requests.</p>

<p>The first issue is that in some circumstances the same cache key can be generated for
two preflight requests on a site. As a result, if a second request is made that will match
the cached key generated by an earlier request, CORS checks will be bypassed because the
system will see the previously cached request as applicable.</p>

<p>In the second issue, when some <code>Access-Control-</code> headers are missing from
CORS responses, the values from different <code>Access-Control-</code> headers can be used
that present in the same response. </p>

<h3>References</h3>

<ul>
  <li><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1200856">
       CORS preflight cache poisoning with the credentials flag</a>
(<a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-4520"
class="ex-ref">CVE-2015-4520</a>)</li>
  <li><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1200869">
       CORS preflight cache poisoning with a CORS header being mistaken with another CORS
header</a></li>
</ul>

